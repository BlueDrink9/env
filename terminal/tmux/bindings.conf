# vim:ft=tmux
# remap prefix
unbind C-b
set-option -g prefix C-s
bind-key C-s send-prefix


set-window-option -g mode-keys vi
# New keybindings for vi-mode
# https://github.com/tmux/tmux/issues/754
if-shell -b '[ "$(echo "$TMUX_VERSION >= 2.4" | bc)" = 1 ]' \
   'bind -T copy-mode-vi v send-keys -X begin-selection ; \
   bind -T copy-mode-vi C-v send-keys -X rectangle-toggle ; \
   bind -T copy-mode-vi y send-keys -X copy-selection-and-cancel ; \
   bind -T copy-mode-vi H send-keys -X start-of-line ; \
   bind -T copy-mode-vi L send-keys -X end-of-line ; \
   bind -T choice-mode-vi h send-keys -X tree-collapse ; \
   bind -T choice-mode-vi l send-keys -X tree-expand ; \
   bind -T choice-mode-vi H send-keys -X tree-collapse-all ; \
   bind -T choice-mode-vi L send-keys -X tree-expand-all ; \
   bind -T copy-mode-emacs MouseDragEnd1Pane send-keys -X copy-pipe "pbcopy"; \
   bind -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe "pbcopy";'

if-shell -b '[ "$(echo "$TMUX_VERSION < 2.4" | bc)" = 1 ]' \
   'bind -t vi-copy v begin-selection; \
   bind -t vi-copy C-v rectangle-toggle; \
   bind -t vi-copy y copy-selection; \
   bind -t vi-choice h tree-collapse; \
   bind -t vi-choice l tree-expand; \
   bind -t vi-choice H tree-collapse-all; \
   bind -t vi-choice L tree-expand-all; \
   bind -t emacs-copy MouseDragEnd1Pane copy-pipe "pbcopy"; \
   bind -t vi-copy MouseDragEnd1Pane copy-pipe "pbcopy";'

unbind p
unbind n
bind p paste-buffer
bind v copy-mode
bind X confirm-before -p "kill-window #W? (y/n)" kill-window

# Attempt to mimic my vim flow as much as possible,
# treating panes like splits, windows like hidden buffers
# (which are like other programs' tabs under airline), and sessions as tabs.
# Use arrow keys to allow faster cycling, as in vim, except with ctrl modifier.

# smart pane switching with awareness of vim splits
bind -n C-h run "(tmux display-message -p '#{pane_current_command}' | grep -iq vim && tmux send-keys C-h) || tmux select-pane -L"
bind -n C-j run "(tmux display-message -p '#{pane_current_command}' | grep -iq vim && tmux send-keys C-j) || tmux select-pane -D"
bind -n C-k run "(tmux display-message -p '#{pane_current_command}' | grep -iq vim && tmux send-keys C-k) || tmux select-pane -U"
bind -n C-l run "(tmux display-message -p '#{pane_current_command}' | grep -iq vim && tmux send-keys C-l) || tmux select-pane -R"
bind -n C-\ run "(tmux display-message -p '#{pane_current_command}' | grep -iq vim && tmux send-keys 'C-\\') || tmux select-pane -l"
# Aand replacements for when vim plugin isn't loading. Prefix first.
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R
# Ctrl arrow to switch windows/tabs
unbind S-Left
unbind S-Right
unbind S-Up
unbind S-Down
unbind C-Left
unbind C-Right
unbind C-Up
unbind C-Down
bind C-Left  previous-window
bind C-Right next-window
bind C-Up  switch-client -p # Session
bind C-Down switch-client -n # Session
unbind t
bind t new-session
unbind e
bind e new-window -a
# bind -n C-t new-window -a
bind s last-window
# Backups, require prefix
bind C-p previous-window
bind C-n next-window

# Move windows left/right.
bind < swap-window -t -1
bind > swap-window -t +1
# Wraps to next/prev line for up/down?
bind S-H swap-pane -L
bind S-L swap-pane -R
bind S-K swap-pane -U
bind S-J swap-pane -D
# prefix shift direction to resize
# -r means you can hold it down/repeat it without the prefix
bind -r S-Left  resize-pane -L 5
bind -r S-Right resize-pane -D 5
bind -r S-Up    resize-pane -U 5
bind -r S-Down  resize-pane -R 5

# Prefix + arrow creates window in that direction
bind Up    split-window -b -v -c "#{pane_current_path}"
bind Down  split-window -v -c "#{pane_current_path}"
bind Left  split-window -b -h -c "#{pane_current_path}"
bind Right split-window -h -c "#{pane_current_path}"
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"

unbind C-Left
unbind C-Right
unbind C-Up
unbind C-Down

unbind \;
unbind :
bind \; command-prompt
bind : last-pane

bind -n S-left  prev
bind -n S-right next
bind -n S-C-left  swap-window -t -1
bind -n S-C-right swap-window -t +1

# To do with using arrow keys with ctrl, amongst others
set-window-option -g xterm-keys on

bind -n S-left  prev
bind -n S-right next
bind -n S-C-left  swap-window -t -1
bind -n S-C-right swap-window -t +1
unbind r
bind r rotate-window

# reload config file (change file location to your the tmux.conf you want to use)
unbind c
bind c source-file ~/.tmux.conf

# When scrolling with mouse wheel, reduce number of scrolled rows per tick to "2" (default is 5)
#bind -T copy-mode-vi WheelUpPane select-pane \; send-keys -X -N 2 scroll-up
#bind -T copy-mode-vi WheelDownPane select-pane \; send-keys -X -N 2 scroll-down

bind-key -n M-1 select-window -t 1
bind-key -n M-2 select-window -t 2
bind-key -n M-3 select-window -t 3
bind-key -n M-4 select-window -t 4
bind-key -n M-5 select-window -t 5
bind-key -n M-6 select-window -t 6
bind-key -n M-7 select-window -t 7
bind-key -n M-8 select-window -t 8
bind-key -n M-9 select-window -t 9


